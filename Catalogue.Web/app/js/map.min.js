(function(){var u,f,i,e,t,r,o,n,s;t=angular.module("app.map");f=function(n,t){var i,r;return r=angular.element(n).innerHeight(),i=angular.element(t).offset().top,r-i-10+"px"};u=L.tileLayer("https://{s}.tiles.mapbox.com/v4/petmon.lp99j25j/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoicGV0bW9uIiwiYSI6ImdjaXJLTEEifQ.cLlYNK1-bfT0Vv4xUHhDBA",{maxZoom:18,attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap<\/a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA<\/a>, Imagery © <a href="http://mapbox.com">Mapbox<\/a>',id:"petmon.lp99j25j"});r={fillOpacity:.2,weight:1,color:"#222"};o={fillOpacity:.5,weight:1,color:"rgb(217,38,103)"};i=function(n){var r,u,f,e,o,s,t,i;return t=n[0],f=t[0],e=t[1],i=n[1],u=i[0],r=i[1],o=r-e,s=u-f,Math.abs(o*s)};e=function(n){var t;return t=function(n){var t,r;return r=_.max(n,function(n){return i(n)}),t=function(n,t){var e,o,s,h,c,l,a,v,i,r,u,f;return i=n[0],c=i[0],a=i[1],r=n[1],s=r[0],e=r[1],u=t[0],l=u[0],v=u[1],f=t[1],h=f[0],o=f[1],c>=l&&s<=h&&a>=v&&e<=o},_.every(n,function(n){return t(n,r)})},t(_.map(n,function(n){return n.bounds}))?{padding:[120,120]}:{padding:[5,5]}};n={};s=function(t,i){var u;return n=function(){var n,e,f;for(f=[],n=0,e=t.length;n<e;n++)u=t[n],u.box!==null&&u.box.north&&f.push(function(n){var u,t;u=[[n.box.south,n.box.west],[n.box.north,n.box.east]];t=L.rectangle(u,r);t.on("mouseover",function(){return t.setStyle({fillOpacity:.4})});t.on("mouseout",function(){return t.setStyle({fillOpacity:.2})});t.on("click",function(){return i.$apply(function(){return i.current.zoomed=n})});return{r:n,bounds:u,rect:t}}(u));return f}()};t.directive("tcSearchMap",function(t){return{link:function(h,c){var a,l;return l=L.map(c[0]),l.addLayer(u),a=L.layerGroup().addTo(l),h.$watch("result.results",function(r){var v,u,o,y;for(s(r,h),a.clearLayers(),v=_(n).sortBy(function(n){return i(n.bounds)}).reverse().value(),o=0,y=v.length;o<y;o++)u=v[o],a.addLayer(u.rect);return c.css("height",f(t,c)),h.current.zoomed=null,n.length>0?(h.current.selected=n[0].r,l.fitBounds(function(){var t,r,i;for(i=[],t=0,r=n.length;t<r;t++)u=n[t],i.push(u.bounds);return i}(),e(n))):void 0}),h.$watch("current.topmost",function(n){if(!h.current.zoomed)return h.current.selected=n}),h.$watch("current.selected",function(t,i){var u,f;if(t!==i)return(u=_(n).find(function(n){return n.r===t}))!=null&&u.rect.setStyle(o),(f=_(n).find(function(n){return n.r===i}))!=null?f.rect.setStyle(r):void 0}),h.$watch("current.zoomed",function(t,i){var r;if(t&&t!==i)return r=_(n).find(function(n){return n.r===t}),l.fitBounds(r.bounds,{padding:[100,100]}),h.current.selected=t})}}});t.directive("tcSearchResultScrollHighlighter",function(t){return{link:function(i,r){var u;return u=angular.element(t),u.bind("scroll",function(){var t,o,f,e;return o=function(){var n,e,i,f;for(i=r.children(),f=[],n=0,e=i.length;n<e;n++)t=i[n],angular.element(t).offset().top>u.scrollTop()&&f.push(t);return f}(),f=function(){var t,r,u,i;for(i=[],t=0,r=n.length;t<r;t++)e=n[t],e.r.id===((u=o[0])!=null?u.id:void 0)&&i.push(e.r);return i}()[0],f?i.$apply(function(){return i.current.topmost=f}):void 0})}}});t.directive("tcStickToTop",function(n,t){return{link:function(i,r){var e,u,f;return f=angular.element(n),u=function(){return{v:f.scrollTop(),e:r.offset().top,w:r.width()}},e=function(){var n;return n=u(),f.bind("scroll",function(){var t;return(t=u(),t.v>t.e)?(r.addClass("stick-to-top"),r.css("width",n.w)):t.v<n.e?(r.removeClass("stick-to-top"),r.css("width","")):void 0})},t(e,100)}}})}).call(this);