(function(){var t,n;angular.module("app.controllers").controller("EditorController",function(t,i,r,u,f){t.lookups={};i.get("../api/topics").success(function(n){return t.lookups.topics=n});t.getSecurityText=n;t.cancel=function(){return t.reset(),t.notifications.add("Edits cancelled")};t.open=function(n,i){n.preventDefault();n.stopPropagation();t[i]=!0};t.save=function(){var n;return n=function(n){var s,i,h,r,e,c,l,o;if(n.data.success)f=n.data.record,t.validation={},t.reset(),t.notifications.add("Edits saved"),u.path("/editor/"+f.id);else for(t.validation=n.data.validation,i=n.data.validation.errors,i.length>0&&t.notifications.add("There were errors"),r=0,c=i.length;r<c;r++)for(s=i[r],o=s.fields,e=0,l=o.length;e<l;e++)h=o[e],t.theForm[h].$setValidity("server",!1);return t.busy.stop()},t.busy.start(),r.recordId!=="00000000-0000-0000-0000-000000000000"?i.put("../api/records/"+f.id,t.form).then(n):i.post("../api/records",t.form).then(n)};t.reset=function(){return t.form=angular.copy(f)};t.isClean=function(){return angular.equals(t.form,f)};t.isSaveHidden=function(){return t.isClean()||f.readOnly};t.isCancelHidden=function(){return t.isClean()};t.isSaveDisabled=function(){return t.isClean()};t.removeKeyword=function(n){return t.form.gemini.keywords.splice($.inArray(n,t.form.gemini.keywords),1)};t.addKeyword=function(){return t.form.gemini.keywords.push({vocab:"",value:""})};t.reset()});n=function(n){switch(n){case 0:return"Open";case 1:return"Restricted";case 2:return"Classified"}};t={errors:[{message:"There was an error"},{message:"There was another error"}]}}).call(this)