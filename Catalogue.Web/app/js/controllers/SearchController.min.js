(function(){angular.module("app.controllers").controller("SearchController",function(n,t,i,r,u){var f,e,o;return f="Topcat:",n.query={q:i.search().q||"",p:0,n:25},n.model={keyword:{value:i.search().value||"",vocab:i.search().vocab||""}},n.searchType={keyword:"keyword",vocab:"vocab",text:"text"},n.model.keyword.value?(console.log("keyword"),n.model.searchType=n.searchType.keyword,n.query.q=n.model.keyword.value):n.model.keyword.vocab?(console.log("vocab"),n.model.searchType=n.searchType.vocab,n.query.q=n.model.vocab.value):(console.log("text"),n.model.searchType=n.searchType.text),n.app={starting:!0},u(function(){return n.app.starting=!1},500),n.range=function(n,t,i){var u,e,r,f;for(i=i===void 0?1:i,e=[],f=[],u=r=0;0<=t?r<=t:r>=t;u=r+=i)f.push(e.push(u));return f},n.maxPages=function(n,t){return Math.ceil(n/t)-1},t.page={title:f},n.changeKeywordResetPageNumber=function(t){return n.model.keyword=t,n.query.p=0,n.model.searchType=n.searchType.keyword,n.query.q=t.value},n.changePageNumber=function(){return n.model.searchType?e():o()},n.decideWhichSearch=function(){return n.query.p=0,n.model.searchType===n.searchType.keyword?(n.model.keyword.value=n.query.q,e()):n.model.searchType===n.searchType.vocab?n.model.keyword.vocab=n.query.q:o()},n.getKeywords=function(n){return r.get("../api/keywords?q="+n).then(function(n){return n.data})},o=function(){if(n.query.q)return i.url(i.path()),i.search("q",n.query.q),i.search("p",n.query.p),i.search("n",n.query.n),t.page={title:f+n.query.q},n.busy.start(),r.get("../api/search?"+$.param(n.query)).success(function(t){if(angular.equals(t.query,n.query))return n.result=t.total===0?{}:t})["finally"](function(){return n.busy.stop()})},e=function(){return i.url(i.path()),i.search("value",n.model.keyword.value),i.search("p",n.query.p),i.search("n",n.query.n),n.busy.start(),r.get("../api/keywordSearch?value="+n.model.keyword.value+"&vocab="+n.model.keyword.vocab+"&p="+n.query.p+"&n="+n.query.n).success(function(t){if(angular.equals(t.query,n.query))return n.result=t.total===0?{}:t})["finally"](function(){return n.busy.stop(),t.page={title:f+n.model.keyword.value}})},n.$watch("query.q",n.decideWhichSearch,!0)})}).call(this)