(function(){angular.module("app.controllers").controller("SearchController",function(n,t,i,r,u){var o,s,h,v,c,f,l,e,a;return o="Topcat ",n.app={starting:!0},u(function(){return n.app.starting=!1},500),n.resultsView="list",a=function(n){return i.search("q",n.q||null),i.search("k",n.k||null)},e=function(t){return n.busy.start(),r.get("../api/search?"+$.param(t)).success(function(i){if(angular.equals(i.query,t))return n.result=i.total===0?{}:i}).error(function(t){return n.notifications.add("Oops! "+t.message)})["finally"](function(){return n.busy.stop()})},l=function(t){return n.busy.start(),r.get("../api/keywords?q="+t.q).success(function(t){return n.keywordSuggestions=t}).error(function(){return n.keywordSuggestions={}})["finally"](function(){return n.busy.stop()})},s=function(t){return a(t),t.q?(l(t),e(t)):t.k?(n.keywordSuggestions={},e(t)):(n.keywordSuggestions={},n.result={})},n.$watch("query",s,!0),f=function(){return{q:null,k:null,p:0,n:25}},n.query=$.extend({},f(),i.search()),n.queryByKeyword=function(t){return n.query=$.extend({},f(),{k:c(t)})},t.page={title:o},n.getKeywords=function(n){return r.get("../api/keywords?q="+n).then(function(n){return n.data})},c=function(n){var t;return t=h(n.vocab,"/")+n.value,t.replace("http://","")},v=function(n){var t,r,f,i,u,e;if(n.indexOf("/")===-1)return{value:n,vocab:""};for(t=n.split("/"),f=t[t.length-1],i="http://",r=u=0,e=t.length-2;u<=e;r=u+=1)i=i.concat(t[r].concat("/"));return{value:f,vocab:i}},h=function(n,t){return n===""||n.indexOf(t,n.length-t.length)!==-1?n:n.concat(t)},n.setPage=function(t){return n.query.p=t-1},n.range=function(n,t,i){var u,e,r,f;for(i=i===void 0?1:i,e=[],f=[],u=r=0;i>0?r<=t:r>=t;u=r+=i)f.push(e.push(u));return f},n.maxPages=function(n,t){return Math.ceil(n/t)-1}})}).call(this);
//# sourceMappingURL=SearchController.min.js.map
