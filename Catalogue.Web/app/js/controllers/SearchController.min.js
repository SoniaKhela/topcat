(function(){angular.module("app.controllers").controller("SearchController",function(n,t,i,r,u){var o,l,f,e,s,h,c;return n.app={starting:!0},u(function(){return n.app.starting=!1},500),n.resultsView="list",c=function(n){return i.search("q",n.q||null),i.search("k",n.k||null)},h=function(t){return n.busy.start(),r.get("../api/search?"+$.param(t,!0)).success(function(i){return console.log(t),console.log(i.query),angular.equals(i.query,t)?n.result=i:void 0}).error(function(t){return n.notifications.add("Oops! "+t.message)})["finally"](function(){return n.busy.stop()})},s=function(t){return t.q?(n.busy.start(),r.get("../api/keywords?q="+t.q).success(function(t){return n.keywordSuggestions=t}).error(function(t){return n.notifications.add("Oops! "+t.message)})["finally"](function(){return n.busy.stop()})):n.keywordSuggestions={}},n.doSearch=function(t){return c(t),t.q||t.k[0]?(s(t),h(t)):(n.result={},n.keywordSuggestions={})},n.$watch("query",n.doSearch,!0),e=function(){return{q:"",k:[],p:0,n:25}},n.query=$.extend({},e(),i.search()),n.addKeywordToQuery=function(t){return n.query.k.length===0?n.query=$.extend({},e(),{k:[f(t)]}):n.query.k.push(f(t))},n.removeKeywordFromQuery=function(t){return n.query.k.splice($.inArray(t,n.query.k),1)},n.querystring=function(){return $.param(n.query,!0)},f=function(n){var t;return t=o(n.vocab,"/")+n.value,t.replace("http://","")},l=function(n){var t,r,f,i,u,e;if(n.indexOf("/")===-1)return{value:n,vocab:""};for(t=n.split("/"),f=t[t.length-1],i="http://",r=u=0,e=t.length-2;u<=e;r=u+=1)i=i.concat(t[r].concat("/"));return{value:f,vocab:i}},o=function(n,t){return n===""||n.indexOf(t,n.length-t.length)!==-1?n:n.concat(t)},n.setPage=function(t){return n.query.p=t-1},n.range=function(n,t,i){var u,e,r,f;for(i=i===void 0?1:i,e=[],f=[],u=r=0;i>0?r<=t:r>=t;u=r+=i)f.push(e.push(u));return f},n.maxPages=function(n,t){return Math.ceil(n/t)-1}})}).call(this);
//# sourceMappingURL=SearchController.min.js.map
