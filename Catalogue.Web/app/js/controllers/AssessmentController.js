// Generated by IcedCoffeeScript 108.0.11
(function() {
  angular.module('app.controllers').controller('AssessmentController', function($scope, $http) {
    var forceTwoDigits, formatDate;
    $scope.assessmentRequest = '{"id": "' + $scope.form.id + '"}';
    if ($scope.form.publication !== null && $scope.form.publication.openData.assessment.completed) {
      formatDate = function(date) {
        var day, month, year;
        year = date.getFullYear();
        month = forceTwoDigits(date.getMonth() + 1);
        day = forceTwoDigits(date.getDate());
        return "" + day + "/" + month + "/" + year;
      };
      forceTwoDigits = function(val) {
        if (val < 10) {
          return "0" + val;
        }
        return val;
      };
      $scope.publishingButtonText = "Completed by " + $scope.form.publication.openData.assessment.completedBy + " on " + formatDate(new Date($scope.form.publication.openData.assessment.completedOnUtc));
    } else {
      $scope.publishingButtonText = "I AGREE";
    }
    return $scope.close = function() {
      return $http.put('../api/publishing/opendata/assess', $scope.assessmentRequest).success(function(result) {
        return $scope.$close(result.record);
      })["catch"](function(error) {
        $scope.notifications.add(error.data.exceptionMessage);
        return $scope.$dismiss();
      });
    };
  });

}).call(this);

//# sourceMappingURL=AssessmentController.js.map
